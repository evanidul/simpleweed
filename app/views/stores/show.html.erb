
<% content_for :head do %>
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
<script type='text/javascript' src='https://www.google.com/jsapi'></script>
<script type='text/javascript'>
	google.load('visualization', '1', {packages:['table']});
	// google.setOnLoadCallback(drawTable);


</script>	

<% end %>

<div class="row">
	<!-- left, main section -->
    <div class="col-md-8">
		<h1 id="name"><%= @store.name %></h1>      

		<!-- pro coding right here -->
		<div class="star-rank">
			<%= image_tag("yellowstar.jpeg", size:"20", class: "star-image") %>
			<%= image_tag("yellowstar.jpeg", size:"20", class: "star-image") %>
			<%= image_tag("yellowstar.jpeg", size:"20", class: "star-image") %>
			<%= image_tag("yellowstar.jpeg", size:"20", class: "star-image") %>
			<%= image_tag("yellowstar.jpeg", size:"20", class: "star-image") %>
			<%= image_tag("yellowstar.jpeg", size:"20", class: "star-image") %>
			<%= image_tag("yellowstar.jpeg", size:"20", class: "star-image") %>
			<%= image_tag("yellowstar.jpeg", size:"20", class: "star-image") %>
			<%= image_tag("yellowstar.jpeg", size:"20", class: "star-image") %>
			<%= image_tag("yellowstar.jpeg", size:"20", class: "star-image") %>
		</div>
		<div class="reviews-link">
			Reviews (100)
		</div>	

		<div class="write-review-button">
			<%= link_to 'Write a Review', store_path(@store), class: 'btn btn-primary' , id: "write-review-button" %>
		</div>	
		<p id="description">
			He moonlight difficult engrossed an it sportsmen. Interested has all devonshire difficulty gay assistance joy. Unaffected at ye of compliment alteration to. Place voice no arise along to. Parlors waiting so against me no. Wishing calling are warrant settled was luckily. Express besides it present if at an opinion visitor. 

			She wholly fat who window extent either formal. Removing welcomed civility or hastened is. Justice elderly but perhaps expense six her are another passage. Full her ten open fond walk not down. For request general express unknown are. He in just mr door body held john down he. So journey greatly or garrets. Draw door kept do so come on open mean. Estimating stimulated how reasonably precaution diminution she simplicity sir but. Questions am sincerity zealously concluded consisted or no gentleman it. 

			Nor hence hoped her after other known defer his. For county now sister engage had season better had waited. Occasional mrs interested far expression acceptance. Day either mrs talent pulled men rather regret admire but. Life ye sake it shed. Five lady he cold in meet up. Service get met adapted matters offence for. Principles man any insipidity age you simplicity understood. Do offering pleasure no ecstatic whatever on mr directly. 
		</p>	

		<h4>First Time Patient Deals </h4>
		<p id="first-time-patient-deals">
			He moonlight difficult engrossed an it sportsmen. Interested has all devonshire difficulty gay assistance joy. Unaffected at ye of compliment alteration to. Place voice no arise along to. Parlors waiting so against me no. Wishing calling are warrant settled was luckily. Express besides it present if at an opinion visitor. 
		</p>

		<h3>Menu</h3>
		<%= link_to 'Edit Menu', store_store_items_path(@store), class: 'btn btn-primary' , id: "edit_store_items" , 'data-no-turbolink' => true %>

		
		</br></br>
			
			<% @grouped_store_items.each do |category, store_items| %>
  			<h3><%= category %></h3>
  			<div id="table_<%= category %>" ></div>

<script>
	(function drawTable() {
	  var data = new google.visualization.DataTable();
	  data.addColumn('string', 'Name');
	  data.addColumn('string', 'Category');
	  data.addColumn('string', '1g');
	  data.addColumn('string', '1/8');
	  data.addColumn('string', '1/4');
	  data.addColumn('string', '1/2');
	  data.addColumn('string', '1 oz');
      
        <% store_items.each do |store_item| %>
    data.addRow(['<%= store_item.name %>',   
     '<%= store_item.category %>',
     '<%= store_item.costonegram %>',
     
     '<%= store_item.costeighthoz %>',
     '<%= store_item.costquarteroz %>',
     '<%= store_item.costhalfoz %>',
     '<%= store_item.costoneoz %>']);
  <% end %>      


      var table = new google.visualization.Table(document.getElementById("table_<%= category %>"));
      table.draw(data, {showRowNumber: false, allowHtml: true});
      
      
      google.visualization.events.addListener(table, 'sort', setWidth);
      setWidth();
	})();

	function setWidth() {
	  var title = "Name";
      var width = "400px";
      $('.google-visualization-table-th:contains(' + title + ')').css('width', width);
	}
</script>

		
			
			
		
		<% end %>

    </div> <!-- end of left container -->

    <!-- right, side bar -->
    <div class="col-md-4">
        <div class="store-map-loc">
		
		<div id="gmap_canvas"></div>
		
		<script type="text/javascript">

  			function codeAddress() {
				    //In this case it gets the address from an element on the page, but obviously you  could just pass it to the method instead
				    
				<% fulladdress = @store.addressline1 + ',' + @store.city + ',' + @store.state + @store.zip  %>

				    geocoder = new google.maps.Geocoder();
				    //var address = "7110 Rock Valley Court, San Diego, CA 92122";
				    var address = "<%= escape_javascript fulladdress %>";

				    geocoder.geocode( { 'address': address}, function(results, status) {
				      if (status == google.maps.GeocoderStatus.OK) {
				        //In this case it creates a marker, but you can get the lat and lng from the location.LatLng
				        console.log(results[0].geometry.location);
						var myOptions = {
							zoom:15,
							center: new google.maps.LatLng(results[0].geometry.location),
							mapTypeId: google.maps.MapTypeId.ROADMAP
						}
				        map = new google.maps.Map(document.getElementById("gmap_canvas"), myOptions);
				        map.setCenter(results[0].geometry.location);
				        var marker = new google.maps.Marker({
				            map: map, 
				            position: results[0].geometry.location
				        });
				        ;
						
						
				      } else {
				        alert("Geocode was not successful for the following reason: " + status);
				      }
				    });
				  }
			google.maps.event.addDomListener(window, "load", codeAddress);
			
		</script>
		</div>
		<!-- end of google maps -->
		<div id="contact">
			<h3>Contact</h3>
			<address>
				<strong><%= @store.name  %></strong><br>
				<%= @store.addressline1  %><br>
				<% if !@store.addressline2.empty?  %>
					<%= @store.addressline2  %><br>
				<% end %>	
				<%= @store.city  %>, <%= @store.state  %> <%= @store.zip  %><br>
				 <%= @store.latitude  %>, <%= @store.longitude  %>
			</address>

			<div id="phonenumber">			
				<%= @store.phonenumber  %>
			</div>
		</div>

		<h3>Daily Specials</h3>
		<table id="dailyspecials">
			<tr>
				<td>Monday</td>
				<td><%= @store.dailyspecialsmonday %></td>
			</tr>
			<tr>
				<td>Tuesday</td>
				<td><%= @store.dailyspecialstuesday %></td>
			</tr>
			<tr>
				<td>Wednesday</td>
				<td><%= @store.dailyspecialswednesday %></td>
			</tr>
			<tr>
				<td>Thursday</td>
				<td><%= @store.dailyspecialsthursday %></td>
			</tr>
			<tr>
				<td>Friday</td>
				<td><%= @store.dailyspecialsfriday %></td>
			</tr>
			<tr>
				<td>Saturday</td>
				<td><%= @store.dailyspecialssaturday %></td>
			</tr>
			<tr>
				<td>Sunday</td>
				<td><%= @store.dailyspecialssunday %></td>
			</tr>
		</table>
		<h3>Dispensary Features</h3>
		<table id="dispensaryfeatures">
			<tr>
				<td>Accepts Credit/Debit cards</td>
				<td><%= check_box_tag :acceptscreditcards , 1 , @store.acceptscreditcards ? true : false, disabled: true %></td>
			</tr>
			<tr>
				<td>ATM Access</td>
				<td><%= check_box_tag :atmaccess , 1 , @store.atmaccess ? true : false, disabled: true %></td>
			</tr>
			<tr>
				<td>Automatic Dispensing Machines</td>
				<td><%= check_box_tag :automaticdispensingmachines , 1 , @store.automaticdispensingmachines ? true : false, disabled: true %></td>
			</tr>
			<tr>
				<td>Delivery Service</td>
				<td><%= check_box_tag :deliveryservice , 1 , @store.deliveryservice ? true : false, disabled: true %></td>
			</tr>
			<tr>
				<td>First Time Patient Deals</td>
				<td><%= check_box_tag :firsttimepatientdeals , 1 , @store.firsttimepatientdeals ? true : false, disabled: true %></td>
			</tr>
			<tr>
				<td>Handicap Access</td>
				<td><%= check_box_tag :handicapaccess , 1 , @store.handicapaccess ? true : false, disabled: true %></td>
			</tr>
			<tr>
				<td>Lounge Area</td>
				<td><%= check_box_tag :loungearea , 1 , @store.loungearea ? true : false, disabled: true %></td>
			</tr>
			<tr>
				<td>Pet Friendly</td>
				<td><%= check_box_tag :petfriendly , 1 , @store.petfriendly ? true : false, disabled: true %></td>
			</tr>
			<tr>
				<td>Security Guard</td>
				<td><%= check_box_tag :securityguard , 1 , @store.securityguard ? true : false, disabled: true %></td>
			</tr>			
		</table>
    </div><!-- end right, side bar -->
</div> <!-- end of 'row' -->


